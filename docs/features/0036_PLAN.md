## Event Templates UI polish – apply BRIEF_0007 feedback

### Context
The Templates page (`ui/src/pages/Templates.tsx`) provides a three-pane layout with: navigation sidebar, template list, and a detail editor for template metadata, Areas, Requirements, and Versions. The goal is to refine hierarchy, clarity, affordances, and discoverability per `docs/briefs/BRIEF_0007-EVENT-TEMPLATE_UI` feedback, without altering the underlying data model or endpoints.

### Relevant files and functions
- UI entry: `ui/src/pages/Templates.tsx`
  - Uses: `listEventTemplates`, `createEventTemplate`, `getEventTemplate`, `updateEventTemplate`, `listTemplateVersions`, `createTemplateVersion`, `activateTemplateVersion`, `getTemplateRequirements`, `putTemplateRequirements`, `listDepartments`, `listPositions`, `getTemplateVersionAreas` from `ui/src/lib/serverComm.ts`.
  - Local components: `RequirementsTable` (inline in file), rollups for "Requirements" and "Versions".
- Areas panel: `ui/src/features/templates/TemplateVersionAreasPanel.tsx`
  - Uses: `listAreas`, `getTemplateVersionAreas`, `addTemplateVersionArea`, `removeTemplateVersionArea`.
- Styling: `ui/src/index.css` (global tokens, surfaces), ShadCN components in `ui/src/components/ui/*` (e.g., `Button`, `Input`, `Badge`, `DropdownMenu`, `Popover`, `Rollup`).
- Data model (reference):
  - `server/drizzle/0034_event_templates.sql`
  - `server/drizzle/0035_event_template_versions.sql`
  - `server/drizzle/0036_event_template_requirements.sql`
- API contracts: `ui/src/lib/serverComm.ts` (types `EventTemplate`, `EventTemplateVersion`, `TemplateRequirementRow`, `Area`, `DepartmentRecord`, `PositionRecord`).

### Test definitions (write before code)
1) Visual hierarchy and sectioning
- Given the detail pane is open, headings for "Template", "Areas", "Requirements", and "Versions" are visually distinct with stronger headers or subtle surface contrast. Assert presence of section headers and role="region" landmarks, and visual tokens via class names.

2) Search affordance
- The left search input labeled "Search templates" must present as a scoped search. Assert it includes helper text or an icon + caption indicating scope, and placeholder updated if required.

3) Requirements table column balance
- The widths for Area/Position/Quantity align with content: Area grows to fit names, Quantity is compact. Assert col widths via classnames or style tokens changed per plan and that long Area names do not truncate prematurely.

4) Add requirement discoverability
- The "Add requirement" control is visually primary within the Requirements section when enabled, and when disabled in "- All -" view it shows a clear helper tooltip/popover explaining why. Assert presence of helper text and aria-describedby from control to helper.

5) Department dropdown clarity
- A small helper caption under the Department select clarifies it filters the Requirements table and that "- All -" is read-only. Assert presence of helper text and that the select has an accessible label.

6) Versioning clarity
- The versions block includes a label like "Saved Versions" and the active/current version is more clearly indicated (e.g., aria-current or a stronger variant). Assert label presence and current indicator on the active button.

7) Areas chips summary
- The Areas rollup summary already shows chips; ensure a visible label and count remain. Assert summary contains count badge and up to N chips.

8) No data states
- Assert empty states are explicit for: no templates, no areas, no requirements, and use muted helper text.

### Implementation steps

Phase 1 – UI structure and hierarchy
- Add a top-level section header in the detail pane for template metadata (e.g., "Template"). Group Name and Description under this header. Use semantic headings and/or `aria-labelledby` on containers.
- Apply subtle background contrast between sections using existing tokens: utilize `bg-[color-mix(...)]` or existing `detailPaneAccent`/`content-surface` variants for sections, avoiding new theme surfaces.

Phase 2 – Requirements UX and table balance
- In `RequirementsTable` within `ui/src/pages/Templates.tsx`:
  - Adjust column widths: increase Area column min/max widths, reduce Quantity width, ensure `Position` remains flexible. Update `w-[220px]`, `w-[320px]`, `w-[120px]` to better balance (e.g., Area 280–320px, Position auto/flex, Quantity 80–96px).
  - Add a helper caption below Department select: "Filters requirements; '- All -' shows read-only view." Keep current sticky persistence behavior.
  - Elevate "Add requirement" button visibility: use `variant="default"` when enabled; keep `variant="outline"` when disabled with Popover explanation. Ensure disabled state uses `aria-disabled` and `Popover` trigger remains accessible.
  - For read-only "- All -" view, ensure row controls (selects/inputs) render non-editable affordances consistently and keep explanation Popover.
  - Consider simple iconography for positions (optional; if adopted, use existing Lucide icons like `User`, `UserCheck`, but only if already imported elsewhere; otherwise skip icon addition to avoid new visuals in this pass).

Phase 3 – Versioning clarity
- Update Versions rollup title to include a clear label "Saved Versions" and keep summary "Current: N".
- Set `aria-current="page"` or `aria-pressed` appropriately on the current version button. Add a tooltip-like helper via existing `title` prop to clarify current vs select.
- Ensure "Set Current" button placement is consistent and secondary.

Phase 4 – Search scope cue and primary actions
- In the left pane, add a small caption under the search input: "Searches templates only" to reinforce scope.
- Make "New Template" visually primary: ensure `variant="default"` and add `title="Create new template"`. Keep placement.

Phase 5 – Areas summary and section heading
- In `TemplateVersionAreasPanel.tsx`, keep the summary chips but add a small static label near chips (e.g., visually hidden label for accessibility) or ensure `Rollup` title “Areas” remains visually strong. Maintain count badge.

Phase 6 – Empty states and helper text
- Ensure empty states are present and consistent:
  - No requirements: "No requirements" (already exists), maintain muted tone.
  - No areas attached: "No areas attached yet" (already exists).
  - No templates: confirm List component empty state behavior; if absent, add a muted message in the left pane when `items.length===0`.

### Specific edits by file
- `ui/src/pages/Templates.tsx`
  - Add a small header element above Name/Description ("Template").
  - Add helper captions under: Search input, Department select.
  - Rebalance table column widths in `RequirementsTable` `<th>` and linked cell inputs.
  - Change "Add requirement" enabled button variant to `default`; preserve disabled popover flow.
  - Versions rollup: change title to "Saved Versions" and add `aria-current` to the active/current version button.

- `ui/src/features/templates/TemplateVersionAreasPanel.tsx`
  - Keep existing summary but ensure the Rollup title visibility is strong; if needed, add a subtle label or retain existing title and ensure summary count badge remains.

- `ui/src/index.css`
  - If needed, add small utility classes only if not achievable with existing Tailwind tokens; prefer inline utility classes first. Avoid global design changes.

### Algorithms and behaviors
- No algorithmic changes to data flow. All server interactions remain via existing functions in `ui/src/lib/serverComm.ts`:
  - Requirements autosave remains debounced 500ms via existing effect; no change.
  - Department `__all__` remains a read-only aggregated view; edits only enabled when a specific department is selected.
  - Areas attach/remove flow continues to call `addTemplateVersionArea`/`removeTemplateVersionArea`.
  - Version selection, creation, and activation behaviors unchanged; only labeling and aria adjusted.

### Out of scope in this pass
- Introducing new icons or a comprehensive icon system for positions (optional later).
- Any backend schema or API changes.
- New components beyond small presentational tweaks.

### Acceptance checks (manual/visual)
- Sections have clear separation and headings; scanning quickly reveals Template, Areas, Requirements, Versions.
- Department select explains its purpose and read-only nature for "- All -".
- Requirements table reads cleanly; long Area names are readable; Quantity column is compact.
- "Add requirement" is discoverable and primary when enabled; disabled state communicates why.
- Versions clearly read as saved versions, with a clear current indicator and accessible semantics.
- Search field communicates scope.
